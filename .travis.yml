language: ruby

rvm:
    - 2.6.5

services:
    - postgresql

before_install:
    - nvm install --lts
    - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
    - echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
    - sudo apt-get update  
    - sudo apt-get install yarn

script:
    - bundle exec rails db:create RAILS_ENV=test
    - bundle exec rails db:migrate
    - bundle exec rails webpacker:compile
    - bundle exec rails test